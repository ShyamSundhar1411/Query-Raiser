{% extends 'base.html' %}
{% block content %}
{% load crispy_forms_tags %}
<div class = "container">
    <h1 class = "text-center">View All Queries</h1>
    <hr/>
    <div class = "container py-2" style = "margin-bottom:20px;">
        <form method = "GET">
            <div class = "row">
                <div class = "col">
                    {{Queries.form.title|as_crispy_field}}
                </div>
                <div class = "col">
                    {{Queries.form.date_of_creation|as_crispy_field}}
                </div>
                <div class = "col">
                    {{Queries.form.status|as_crispy_field}}
                </div>
                {% if user.profile.role == "Program Representative" %}
                <div class = "col">
                    {{Queries.form.department|as_crispy_field}}
                </div>
                <div class = "col">
                    {{Queries.form.admitted_year|as_crispy_field}}
                </div>
                {% endif %}
            </div>
            <div class = "d-inline-block py-2" style = "margin-bottom:15px;">
                <button type = "submit" class = "btn btn-primary">Filter</button>
            </div>
        </form>
    </div>
    <ul class="list-group">
        {% if Queries.qs %}
        {% for query in Queries.qs %}
        {% if query.status == "Pending Approval" %}
            <a href = "{% url 'query_detail_view' query.slug query.id %}" class="list-group-item list-group-item-action list-group-item-info">
                {% if user.profile.role == "Program Representative" %}
                {{query.title}} - {{query.department}} -  {{query.admitted_year}}
                {% else %}
                {{query.title}}
                {% endif %}
            </a>
        {% elif query.status == "Rejected" %}
            <a href = "{% url 'query_detail_view' query.slug query.id %}" class="list-group-item list-group-item-action list-group-item-danger">
                {% if user.profile.role == "Program Representative" %}
                    {{query.title}} - {{query.department}} - {{query.admitted_year}}
                {% else %}
                    {{query.title}}
                {% endif %}
            </a>
        {% else %}
            <a href = "{% url 'query_detail_view' query.slug  query.id %}" class="list-group-item list-group-item-action list-group-item-success">
                {% if user.profile.role == "Program Representative" %}
                {{query.title}} - {{query.department}} - {{query.admitted_year}}
                {% else %}
                {{query.title}}
                {% endif %}
            </a>
        {% endif %}
        {% endfor %}
        {% else %}
            <h1 class = "text-center">No Results Found !!!</h1>
        {% endif %}
    </ul>
    <div class = "d-inline-block py-2" style = "margin-top:20px;margin-bottom:10px;">
        <a href = "{% url 'create_query' %}" class = "btn btn-primary" data-bss-hover-animate="pulse"><i class="fa-solid fa-plus"></i> Add a Query</a>
    </div>
</div>
{% endblock %}
